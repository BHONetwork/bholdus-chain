<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Balance the weight distribution of a given `voters` at most `iterations` times, or up until the point where the biggest difference created per iteration of all stakes is `tolerance`. If this is called with `tolerance = 0`, then exactly `iterations` rounds will be executed, except if no change has been made (`difference = 0`)."><meta name="keywords" content="rust, rustlang, rust-lang, balance"><title>sp_npos_elections::balancing::balance - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc fn"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../sp_npos_elections/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><div class="sidebar-elems"><p class="location"><a href="../index.html">sp_npos_elections</a>::<wbr><a href="index.html">balancing</a></p><div id="sidebar-vars" data-name="balance" data-ty="fn" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Function <a href="../index.html">sp_npos_elections</a>::<wbr><a href="index.html">balancing</a>::<wbr><a class="fn" href="">balance</a></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/sp_npos_elections/balancing.rs.html#55-75" title="goto source code">[src]</a></span></h1><pre class="rust fn">pub fn balance&lt;AccountId:&nbsp;<a class="trait" href="../../sp_npos_elections/trait.IdentifierT.html" title="trait sp_npos_elections::IdentifierT">IdentifierT</a>&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;voters: &amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../../sp_npos_elections/struct.Voter.html" title="struct sp_npos_elections::Voter">Voter</a>&lt;AccountId&gt;&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;iterations: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;tolerance: <a class="type" href="../../sp_npos_elections/type.ExtendedBalance.html" title="type sp_npos_elections::ExtendedBalance">ExtendedBalance</a><br>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></pre><div class="docblock"><p>Balance the weight distribution of a given <code>voters</code> at most <code>iterations</code> times, or up until the
point where the biggest difference created per iteration of all stakes is <code>tolerance</code>. If this
is called with <code>tolerance = 0</code>, then exactly <code>iterations</code> rounds will be executed, except if no
change has been made (<code>difference = 0</code>).</p>
<p>In almost all cases, a balanced solution will have a better score than an unbalanced solution,
yet this is not 100% guaranteed because the first element of a <a href="../../sp_npos_elections/type.ElectionScore.html" title="crate::ElectionScore"><code>crate::ElectionScore</code></a> does not
directly related to balancing.</p>
<p>Note that some reference implementation adopt an approach in which voters are balanced randomly
per round. To advocate determinism, we don’t do this. In each round, all voters are exactly
balanced once, in the same order.</p>
<p>Also, note that due to re-distribution of weights, the outcome of this function might contain
edges with weight zero. The call site should filter such weight if desirable. Moreover, the
outcome might need balance re-normalization, see <code>Voter::try_normalize</code>.</p>
<h3 id="references" class="section-header"><a href="#references">References</a></h3>
<ul>
<li><a href="https://dl.acm.org/doi/10.1145/48014.61051">A new approach to the maximum flow problem</a>.</li>
<li><a href="https://arxiv.org/abs/2004.12990">Validator election in nominated proof-of-stake</a> (Appendix
A.)</li>
</ul>
</div></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="sp_npos_elections" data-search-js="../../search-index.js"></div>
    <script src="../../main.js"></script></body></html>